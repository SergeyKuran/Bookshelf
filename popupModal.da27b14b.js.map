{"mappings":"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","sources":["src/js/popup/popupModal.js","src/js/api/fetchBooks.js","src/js/popup/marcupForPopUp.js","src/data/shopsImages.js","node_modules/@parcel/runtime-js/lib/runtime-9c5c1cfb8e01f9b6.js","node_modules/@parcel/runtime-js/lib/runtime-d18da90cb7be7ea2.js","node_modules/@parcel/runtime-js/lib/runtime-0df202fbf75a9678.js","node_modules/@parcel/runtime-js/lib/runtime-e3fd687143b371f0.js","node_modules/@parcel/runtime-js/lib/runtime-da0491353072a908.js","node_modules/@parcel/runtime-js/lib/runtime-43c9e31c6bf24b87.js","node_modules/@parcel/runtime-js/lib/runtime-bbb108667bbb4bfc.js"],"sourcesContent":["import { AxiosApi } from '../api/fetchBooks';\n\nimport { createPopupCard } from './marcupForPopUp';\n\nconst axiosApi = new AxiosApi();\nconst LOCALSTORAGE_KEY = 'books';\n\nconst htmlEl = document.querySelector('html');\nconst popupModal = document.createElement('div');\npopupModal.classList.add('backdrop');\n\nconst chosenBook = document.querySelector('.js-all-books');\n\nlet bookInStorage = JSON.parse(localStorage.getItem(LOCALSTORAGE_KEY)) || [];\nlet idBook = null;\n\n/**\n * Get Books From Storage\n * @returns array\n */\nconst getBooksFromStorage = () => {\n  try {\n    return JSON.parse(localStorage.getItem(LOCALSTORAGE_KEY)) ?? [];\n  } catch (error) {\n    console.error(error);\n    return [];\n  }\n};\n\n/**\n * Add listener for Escape key\n * @param {keydown} evt\n */\nconst onEscape = evt => {\n  if (evt.key !== 'Escape') {\n    return;\n  }\n  animationCloseModal();\n};\n\n/**\n * Fetch book from backend, render HTML\n * @param {*} e\n * @returns\n */\nasync function onClick(e) {\n  const currentEl = e.target.parentElement;\n\n  if (!currentEl.classList.contains('js-book')) {\n    return;\n  }\n\n  idBook = e.target.parentElement.dataset.id;\n\n  document.addEventListener('keydown', onEscape);\n\n  let check = checkBookInStorage(idBook)\n    ? 'REMOVE FROM THE SHOPPING LIST'\n    : 'ADD TO SHOPPING LIST';\n\n  try {\n    //Fetchs books from backend\n    const responce = await axiosApi.getShops(idBook);\n    const nodeEl = responce.data;\n\n    //Add HTML render for modal window, check class hidden in text congratulation\n    popupModal.innerHTML = createPopupCard(nodeEl, check);\n    let textCongrats = popupModal.querySelector('.pop-up__congratulations');\n    if (checkBookInStorage(idBook)) {\n      textCongrats.classList.remove('hidden');\n    } else {\n      textCongrats.classList.add('hidden');\n    }\n    document.body.appendChild(popupModal);\n\n    //Stop scrolling body\n    htmlEl.classList.add('scrollable');\n\n    //Button for adding books to bascket(cart)\n    const addHandler = popupModal.querySelector('.js-add-storage');\n    addHandler.addEventListener('click', evt => {\n      addBookToShoppingList(idBook, evt);\n    });\n\n    //Close modal window button\n    const btnPopupClose = popupModal.querySelector('.js-popup-close');\n    btnPopupClose.addEventListener('click', onCloseByButton);\n\n    //Close modal by click on backdrop\n    popupModal.addEventListener('click', onCloseByClickBackdrop);\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n//Close modal window, remove event listeners\nfunction onCloseByButton(evt) {\n  if (!evt.target) {\n    return;\n  }\n  animationCloseModal();\n}\n\n// Close By Click on Backdrop\nfunction onCloseByClickBackdrop(evt) {\n  if (!evt.target.classList.contains('backdrop')) {\n    return;\n  }\n  animationCloseModal();\n}\n\n//Adds book to shopping cart(bascket)\nfunction addBookToShoppingList(idBook, evt) {\n  evt.target.blur();\n\n  const textCongrats = popupModal.querySelector('.pop-up__congratulations');\n\n  if (checkBookInStorage(idBook)) {\n    textCongrats.classList.add('hidden');\n    removeBookFromShoppingList(idBook);\n\n    evt.target.textContent = 'ADD TO SHOPPING LIST';\n\n    return;\n  } else {\n    textCongrats.classList.remove('hidden');\n    bookInStorage.push(idBook);\n    localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(bookInStorage));\n    evt.target.textContent = 'REMOVE FROM THE SHOPPING LIST';\n\n  }\n}\n\n//Removes book from shopping list\nfunction removeBookFromShoppingList(idBook) {\n  bookInStorage = getBooksFromStorage().filter(item => item !== idBook);\n  localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(bookInStorage));\n\n  return;\n}\n\nfunction checkBookInStorage(idBook) {\n  return getBooksFromStorage().includes(idBook);\n}\n\nfunction animationCloseModal() {\n  document.querySelector('.pop-up').classList.add('pop-up__close');\n  const backdropCloseEl = document.querySelector('.backdrop');\n  backdropCloseEl.classList.add('backdrop__close');\n\n  setTimeout(() => {\n    backdropCloseEl.classList.remove('backdrop__close');\n    document.body.removeChild(popupModal);\n    htmlEl.classList.remove('scrollable');\n    document.removeEventListener('keydown', onEscape);\n  }, 200);\n}\n\nchosenBook.addEventListener('click', onClick);\n\n\n// function writeUserBooks(userId,books) {\n//   const db = getDatabase();\n//   push(ref(db, 'users/' + userId), {\n//     selectedBooks: books,\n//   });\n// }\n\n// const auth = getAuth();\n// onAuthStateChanged(auth, (user) => {\n//   if (user) {\n//     // User is signed in, see docs for a list of available properties\n//     // https://firebase.google.com/docs/reference/js/firebase.User\n//     const uid = user.uid;\n//     console.log(uid);\n//     // ...\n//   } else {\n//    console.log('usera ne ma');\n//     // ...\n//   }\n// });\n\n// const auth = getAuth();\n// const user = auth.currentUser;\n\n// if (user) {\n//   // User is signed in, see docs for a list of available properties\n//   // https://firebase.google.com/docs/reference/js/firebase.User\n//   // ...\n// } else {\n//   // No user is signed in.\n// }\n\n// import { getAuth, onAuthStateChanged } from \"firebase/auth\";\n// import { takeUserId } from '../firebase';\n// import { getDatabase, ref, set, child, get, push } from 'firebase/database';\n// import { writeUserBooks } from '../firebase';","import axios from 'axios';\n\nexport class AxiosApi {\n  #BASE_URL = 'https://books-backend.p.goit.global/books/';\n\n  async getShops(bookId) {\n    const url = `${this.#BASE_URL}${bookId}`;\n\n    const result = await axios.get(url);\n    return result;\n  }\n}\n","import { bookShopsIcons } from '../../data/shopsImages';\n\nconst stores = ['Amazon', 'Apple Books', 'Bookshop'];\n\n//Creates HTML render of shop links for modal window\nfunction createShopLinks(buyLinks) {\n  const filteredShops = stores.map(storeName =>\n    buyLinks.find(({ name }) => name === storeName)\n  );\n\n  const markupShops = filteredShops\n    .map(\n      ({ name, url }, idx) => `\n      <li class=\"stores-list__item\">\n        <a href=\"${url}\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">\n          <img\n            srcset=\"${bookShopsIcons[idx].x1} 1x, ${bookShopsIcons[idx].x2} 2x\"\n            src=\"${bookShopsIcons[idx].x1}\"\n            alt=\"${name}\" \n            width=\"${bookShopsIcons[idx].width}\" \n            height=\"${bookShopsIcons[idx].height}\"\n            class=\"stores-img${!idx ? '__amazon' : ''}\">\n        </a>\n      </li>`\n    )\n    .join('');\n\n  return markupShops;\n}\n\nfunction createPopupCard(\n  { author, book_image, title, buy_links, description },\n  check\n) {\n  return `\n      <div class=\"pop-up scrollable\">\n        <div class=\"pop-up__book-info\">\n          <img class=\"pop-up__img\" src=\"${book_image}\" alt=\"${title}\">\n          <div class=\"pop-up__description\">\n            <h2 class=\"pop-up__book-name\">${title}</h2>\n            <h2 class=\"pop-up__book-author\">${author}</h2>\n            <p class=\"pop-up__review\">${\n              !description ? 'Description' : description\n            }</p>\n            <ul class=\"stores-list\">${createShopLinks(buy_links)}</ul>\n          </div>\n        </div>\n        <div class=\"pop-up__btn\">\n        <button class=\"action-button pop-up__action-button js-add-storage\">${check}</button>\n        <p class=\"pop-up__congratulations\">Congratulations! You have added the book to the shopping list. To delete, press the button “Remove from the shopping list”.</p>\n        </div>\n        <button class=\"js-popup-close close-button\" type=\"button\">\n          <img src=\"${new URL(\n            `../../images/icon-x-close.svg`,\n            import.meta.url\n          )}\" width=\"24\" height=\"24\">\n        </button>\n      </div>`;\n}\n\nexport { createPopupCard };\n","import amazon1x from '../images/shoplist/amazon1x.png';\nimport amazon2x from '../images/shoplist/amazon2x.png';\nimport apple1x from '../images/shoplist/apple1x.png';\nimport apple2x from '../images/shoplist/apple2x.png';\nimport bookshop1x from '../images/shoplist/bookshop1x.png';\nimport bookshop2x from '../images/shoplist/bookshop2x.png';\n\nconst bookShopsIcons = [\n  {\n    x1: amazon1x,\n    x2: amazon2x,\n    width: '62',\n    height: '19',\n  },\n  {\n    x1: apple1x,\n    x2: apple2x,\n    width: '33',\n    height: '32',\n  },\n  {\n    x1: bookshop1x,\n    x2: bookshop2x,\n    width: '38',\n    height: '36',\n  },\n];\n\nexport { bookShopsIcons };\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"1StS0\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"igOR5\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"cLJUC\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"38YEC\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"iYgR8\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"kLMPf\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"d81E4\")).toString();"],"names":["$2OfAl","parcelRequire","$0ba687617202890c$var$axiosApi","AxiosApi","$0ba687617202890c$var$LOCALSTORAGE_KEY","$0ba687617202890c$var$htmlEl","document","querySelector","$0ba687617202890c$var$popupModal","createElement","classList","add","$0ba687617202890c$var$chosenBook","$0ba687617202890c$var$bookInStorage","JSON","parse","localStorage","getItem","$0ba687617202890c$var$idBook","$0ba687617202890c$var$getBooksFromStorage","error","console","$0ba687617202890c$var$onEscape","evt","key","$0ba687617202890c$var$animationCloseModal","$0ba687617202890c$var$onCloseByButton","target","$0ba687617202890c$var$onCloseByClickBackdrop","contains","$0ba687617202890c$var$checkBookInStorage","idBook3","includes","backdropCloseEl","setTimeout","remove","body","removeChild","removeEventListener","addEventListener","async","e","parentElement","dataset","id","check","nodeEl","getShops","data","innerHTML","$bja6l","createPopupCard","textCongrats","appendChild","idBook1","blur","idBook2","filter","item","setItem","stringify","textContent","push","$0ba687617202890c$var$addBookToShoppingList","log","$2shzp","$20bc572dfdce3226$export$166206578d5f52f9","BASE_URL","bookId","url","this","default","get","$a1pCD","$83b94dfdec30722a$var$stores","$83b94dfdec30722a$export$543f96ea4a82562b","author","book_image","title","buy_links","description","buyLinks","map","storeName","find","name","idx","bookShopsIcons","x1","x2","width","height","join","URL","$kSibX","$74bddf6af8850a82$export$3f389b1914c95d5d","$parcel$interopDefault","$2iOZk","$8zDEN","$3KaUB","$dZQ1Q","$8EpWk","module","exports","resolve","import","meta","toString"],"version":3,"file":"popupModal.da27b14b.js.map"}