{"mappings":"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","sources":["src/js/popup/popupModal.js","src/js/api/fetchBooks.js","<<jsx-config-pragma.js>>","node_modules/@swc/helpers/lib/_class_private_field_get.js","node_modules/@swc/helpers/lib/_class_extract_field_descriptor.js","node_modules/@swc/helpers/lib/_class_apply_descriptor_get.js","node_modules/@swc/helpers/lib/_class_private_field_init.js","node_modules/@swc/helpers/lib/_check_private_redeclaration.js"],"sourcesContent":["import { AxiosApi } from '../api/fetchBooks';\nimport saveStorageHandler from './localStorageHandler';\n\nconst axiosApi = new AxiosApi();\nconst LOCALSTORAGE_KEY = 'books';\nconst popupModal = document.createElement('div');\nconst chosenBook = document.querySelector('.js-all-books');\nlet bookInStorage = [];\nlet idBook = null;\n\nchosenBook.addEventListener('click', onClick);\n\nasync function onClick(e) {\n  const currentEl = e.target.parentElement;\n  if (!currentEl.classList.contains('js-book')) {\n    return;\n  }\n\n  idBook = e.target.parentElement.dataset.id;\n  let check = checkBookInStorage(idBook)\n    ? 'REMOVE FROM THE SHOPPING LIST'\n    : 'ADD TO SHOPPING LIST';\n  console.log(check);\n\n  try {\n    //Fetchs books from backend\n    const responce = await axiosApi.getShops(idBook);\n    const nodeEl = responce.data;\n\n    //Adds HTML render for modal window\n    popupModal.innerHTML = createPopupCard(nodeEl);\n    document.body.appendChild(popupModal);\n\n    //Button for adding books to bascket(cart)\n    const addHandler = popupModal.querySelector('.js-add-storage');\n    console.dir(addHandler);\n\n    addHandler.addEventListener('click', evt => {\n      addBookToShoppingList(idBook);\n\n      // console.log(idBook);\n    });\n\n    //Close modal window button\n    const btnPopupClose = popupModal.querySelector('.js-popup-close');\n    btnPopupClose.addEventListener('click', onClose);\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n//Creates HTML render for modal window\nfunction createPopupCard({\n  author,\n  book_image,\n  title,\n  buy_links,\n  list_name,\n  description,\n}) {\n  return `<div class=\"popup-backdrop\">\n  <div class=\"js-popup popup__body\">\n  <div class=\"popup__container\">\n  <button  class=\"js-popup-close btn__close\" type=\"button\">\n        <svg width=\"16\" height=\"15\"></svg>\n        <use href=\"./images/sprite.svg#icon-x-close\"></use>\n        </svg>\n    </button>\n    <div class=\"popup-book\">\n    <div class=\"popup-book__thumb\">\n        <img class=\"popup-book__img\" src=\"${book_image}\" alt=\"${title}\">\n        </div>\n    <div class=\"popup-book__info\"\n        <h2>${title}</h2>\n        <h3>${author}</h3>\n        <p>${description}</p>\n        <ul class=\"modal__shops-link\">${createShopLinks(buy_links)}</ul>\n        </div>\n    </div>\n    <div>\n        <button type=\"button\" class=\"action-button js-add-storage\">add to shoping list</button>\n        <p class=\"popup__text\">text</p>\n    </div>\n    </div>\n    </div>\n    </div>`;\n}\n\n//Creates HTML render of shop links for modal window\nfunction createShopLinks(buyLinks) {\n  const filteredShops = buyLinks.filter(\n    ({ name }) =>\n      name === 'Amazon' || name === 'Apple Books' || name === 'Bookshop'\n  );\n\n  const markupShops = filteredShops\n    .map(\n      ({ name, url }) => `  <li>\n                <a href=\"${url}\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">\n                    <img src=\"\" alt=\"${name}\">\n                </a>\n            </li>`\n    )\n    .join('');\n  return markupShops;\n}\n\n//Closes modal window, removes event listeners\nfunction onClose(evt) {\n  if (!evt.target) {\n    return;\n  } else {\n    document.body.removeChild(popupModal);\n    document.removeEventListener('keyup', onEscape);\n  }\n}\n\n//Adds book to shopping cart(bascket)\nfunction addBookToShoppingList(idBook) {\n  if (checkBookInStorage(idBook)) {\n    removeBookFromShopingList(idBook);\n    return;\n  }\n  bookInStorage.push(idBook);\n  localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(bookInStorage));\n  console.log(bookInStorage);\n}\n\n//Removes book from shopping cart(bascket)\nfunction removeBookFromShopingList(idBook) {\n  let arr = JSON.parse(localStorage.getItem(LOCALSTORAGE_KEY));\n  arr = arr.filter(item => item !== idBook);\n  localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(arr));\n}\n\n//Adds listener for Escape key\nconst onEscape = evt => {\n  if (evt.key === 'Escape') {\n    document.body.removeChild(popupModal);\n    document.removeEventListener('keyup', onEscape);\n  }\n};\ndocument.addEventListener('keydown', onEscape);\n\nfunction checkBookInStorage(idBook) {\n  bookInStorage = JSON.parse(localStorage.getItem(LOCALSTORAGE_KEY)) ?? [];\n  if (!bookInStorage.includes(idBook)) {\n    return false;\n  }\n  return true;\n}\n","import axios from 'axios';\n\nexport class AxiosApi {\n  #BASE_URL = 'https://books-backend.p.goit.global/books/';\n\n  async getShops(bookId) {\n    const url = `${this.#BASE_URL}${bookId}`;\n\n    const result = await axios.get(url);\n    return result;\n  }\n}\n",null,"\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _classPrivateFieldGet;\nvar _classExtractFieldDescriptor = _interopRequireDefault(require(\"./_class_extract_field_descriptor\"));\nvar _classApplyDescriptorGet = _interopRequireDefault(require(\"./_class_apply_descriptor_get\"));\nfunction _classPrivateFieldGet(receiver, privateMap) {\n    var descriptor = (0, _classExtractFieldDescriptor).default(receiver, privateMap, \"get\");\n    return (0, _classApplyDescriptorGet).default(receiver, descriptor);\n}\nfunction _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n        default: obj\n    };\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _classExtractFieldDescriptor;\nfunction _classExtractFieldDescriptor(receiver, privateMap, action) {\n    if (!privateMap.has(receiver)) {\n        throw new TypeError(\"attempted to \" + action + \" private field on non-instance\");\n    }\n    return privateMap.get(receiver);\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _classApplyDescriptorGet;\nfunction _classApplyDescriptorGet(receiver, descriptor) {\n    if (descriptor.get) {\n        return descriptor.get.call(receiver);\n    }\n    return descriptor.value;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _classPrivateFieldInit;\nvar _checkPrivateRedeclaration = _interopRequireDefault(require(\"./_check_private_redeclaration\"));\nfunction _classPrivateFieldInit(obj, privateMap, value) {\n    (0, _checkPrivateRedeclaration).default(obj, privateMap);\n    privateMap.set(obj, value);\n}\nfunction _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n        default: obj\n    };\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _checkPrivateRedeclaration;\nfunction _checkPrivateRedeclaration(obj, privateCollection) {\n    if (privateCollection.has(obj)) {\n        throw new TypeError(\"Cannot initialize the same private elements twice on an object\");\n    }\n}\n"],"names":["$bpxeT","parcelRequire","$4008f2abd9d9c4c1$var$axiosApi","$5McxV","AxiosApi","$4008f2abd9d9c4c1$var$LOCALSTORAGE_KEY","$4008f2abd9d9c4c1$var$popupModal","document","createElement","$4008f2abd9d9c4c1$var$chosenBook","querySelector","$4008f2abd9d9c4c1$var$bookInStorage","$4008f2abd9d9c4c1$var$idBook","$4008f2abd9d9c4c1$var$_onClick","$parcel$interopDefault","$2TvXO","mark","_callee","e","check","responce","nodeEl","addHandler","target","parentElement","classList","contains","dataset","id","$4008f2abd9d9c4c1$var$checkBookInStorage","console","log","getShops","_ctx","sent","data","innerHTML","$4008f2abd9d9c4c1$var$createPopupCard","body","appendChild","dir","addEventListener","evt","$4008f2abd9d9c4c1$var$addBookToShoppingList","$4008f2abd9d9c4c1$var$onClose","t0","apply","this","arguments","param","filteredShops","markupShops","author","book_image","title","buy_links","description","list_name","concat","filter","name","map","url","join","removeChild","removeEventListener","$4008f2abd9d9c4c1$var$onEscape","idBook1","idBook2","arr","JSON","parse","localStorage","getItem","item","setItem","stringify","push","key","idBook3","ref","includes","$434b2ad8bdbd2617$var$_BASE_URL","WeakMap","$434b2ad8bdbd2617$export$166206578d5f52f9","$8MQK7","bookId","result","$4KMWL","_this","$dIxxU","default","get","Object","defineProperty","module","exports","value","receiver","privateMap","descriptor","$37616d1d2d9e1de3$var$_classExtractFieldDescriptor","$37616d1d2d9e1de3$var$_classApplyDescriptorGet","$37616d1d2d9e1de3$var$_interopRequireDefault","obj","__esModule","action","has","TypeError","call","$665bb80dc57e205a$var$_checkPrivateRedeclaration","set","privateCollection"],"version":3,"file":"popupModal.ef4d0832.js.map"}